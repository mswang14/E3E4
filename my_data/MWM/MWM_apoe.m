%average over 4 trials 
swimtime=[37.125	35.175	18.975	28.725	38.125
24.525	27.725	17.075	16.175	18.875
42.16666667	10.25	58.525	30.325	17.2
29.275	22.975	15.4	10.9	11.55
60	55.725	15.925	38.775	11.625
38.475	42.775	14.625	20.55	11.3
42.8	36.375	13.675	18.325	11
40.625	40.125	41.8	28.7	9.75
27.725	30.475	40.2	14.75	6.475
20.1	19.975	17.275	14.175	12.525
39.375	35.4	37	23.125	11.1
60	49.8	35.825	31.45	22.375
60	39.875	36.15	15.6	16.45
60	31.45	11.1	18.175	13.075
60	35.7	20.975	18.775	16.55
41.425	12.3	12.45	5.175	16.6
53.4	48.875	11.2	6.05	18.125
46.45	17.55	14.45	19.125	33.325
40.625	24.9	23.4	9.366666667	17.45
45.175	18.675	22.9	9.575	7.875
60	36.475	14.15	46.225	21.45
47.2	19.025	11.95	8.925	12.525
37.7	36.525	13.35	25.2	22.225
31.35	31.575	21.5	9.475	13.45
38.4	36.725	16.15	31.25	36.15
42.525	28.95	40	23.575	16.875
52.8	41.275	43.6	18.075	13.125
60	48.05	40.675	12.66666667	17.1
40.4	43.7	30.825	28.85	25.425
38.4	18.325	26.7	13.625	15
56.775	42.25	41.325	39.525	34.4
27.825	35	52.1	40.55	25
37.825	39.225	19.575	26.075	26.25
47	33.3	36.125	30.225	17.5
38.525	39.525	26.225	25.45	8.425
51.6	45.7	60	54.75	51.75
39	40.2	28.25	38.95	25.35
45.525	60	41.3	24.975	14.425
60	60	42.85	29.9	32
53.35	47.5	37.025	35.925	23
45.725	37.225	22	26.5	11.425
39.725	34.175	15.975	23.825	20.55];

%trial 4 only
swimdist=[69.0555	54.2985	19.65625	38.018	47.801
19.43525	36.871	18.034	12.11825	13.41275
70.68333333	12.35575	68.76025	30.0865	29.62775
37.207	34.38025	18.73875	7.538	8.49675
97.9375	81.5255	15.29725	52.2995	6.93175
54.069	77.09325	26.154	31.889	12.29825
67.35925	63.80325	13.656	23.11425	12.5935
72.10325	67.94075	60.50925	52.48775	9.79125
48.21925	45.1055	58.1905	16.043	3.1545
27.2925	24.52325	24.1215	19.37775	17.60775
56.79775	69.09625	61.214	35.46975	6.645
107.09775	90.8665	66.3185	49.866	29.11175
103.22225	63.96725	61.14025	20.16425	13.9865
100.0845	54.74125	12.61	19.4025	17.485
106.64725	50.702	33.626	22.9175	14.87125
64.426	16.5835	14.52725	6.139666667	22.11425
80.9115	97.85266667	13.63425	7.407	19.68925
74.55325	31.324	30.29433333	28.66925	55.99475
54.692	28.96425	30.775	7.956	25.9
67.92425	27.1045	44.14666667	12.09375	5.1045
105.5085	64.18025	14.7645	67.6705	26.457
83.394	33.88	17.27225	15.24025	17.608
48.70266667	69.514	21.04925	37.256	34.65075
49.235	53.4875	33.348	13.167	16.854
64.14966667	63.5985	23.278	51.08675	29.75875
71.72625	47.8665	61.99225	27.39125	19.263
50.13625	62.69675	72.20166667	13.921	10.98725
79.5185	73.2505	65.737	14.46433333	21.72925
59.3785	75.2985	50.62775	32.807	27.5465
61.2385	22.38475	31.414	13.00325	17.4275
81.86975	54.21675	53.586	45.26125	36.95275
42.71566667	36.658	48.3665	41.451	24.9165
68.92425	70.227	28.29225	39.82875	36.63325
40.4515	36.502	28.88225	22.5895	13.2325
28.39875	33.45166667	33.954	34.14225	8.16075
57.70725	57.486	67.59675	65.54825	58.846
21.28133333	39.2225	33.487	40.976	23.3515
58.82975	80.9195	59.772	20.9265	15.24825
38.641	62.34475	38.0835	21.2625	28.538
60.37825	50.3085	39.755	31.668	17.73075
36.50225	45.3185	23.786	25.76875	12.413
59.0425	53.3725	26.17825	36.77275	22.84375];

swimspeed=[1.860080808	1.543667377	1.035902503	1.323516101	1.253796721
0.792466871	1.329882777	1.056163982	0.749196291	0.710609272
1.676284585	1.205439024	1.174886801	0.992135202	1.722543605
1.270947908	1.496420022	1.216801948	0.691559633	0.735649351
1.632291667	1.46299686	0.960580848	1.348794326	0.59627957
1.405302144	1.802296902	1.788307692	1.551776156	1.088340708
1.573814252	1.754041237	0.998610603	1.261350614	1.144863636
1.774849231	1.693227414	1.447589713	1.828841463	1.004230769
1.739197475	1.480082034	1.447524876	1.087661017	0.487181467
1.357835821	1.227697121	1.396324168	1.367037037	1.405808383
1.44248254	1.951871469	1.654432432	1.533827027	0.598648649
1.7849625	1.824628514	1.851179344	1.585564388	1.301083799
1.720370833	1.604194357	1.691293223	1.292580128	0.850243161
1.668075	1.740580286	1.136036036	1.067537827	1.337284895
1.777454167	1.42022409	1.603146603	1.220639148	0.898564955
1.555244418	1.348252033	1.16684739	1.186409018	1.332183735
1.515196629	2.002100597	1.21734375	1.224297521	1.086303448
1.605021529	1.784843305	2.096493656	1.499045752	1.680262566
1.346264615	1.163222892	1.31517094	0.849395018	1.484240688
1.50358052	1.451378849	1.927802038	1.26305483	0.648190476
1.758475	1.759568197	1.043427562	1.463937263	1.233426573
1.766822034	1.780814717	1.445376569	1.707591036	1.405828343
1.291847922	1.903189596	1.576722846	1.478412698	1.559088864
1.570494418	1.693982581	1.551069767	1.389656992	1.253085502
1.670564236	1.731749489	1.441362229	1.634776	0.823201936
1.686684303	1.653419689	1.54980625	1.161876988	1.141511111
0.949550189	1.519000606	1.656001529	0.770179806	0.83712381
1.325308333	1.5244641	1.616152428	1.141921053	1.270716374
1.469764851	1.723077803	1.64242498	1.137157712	1.083441495
1.594752604	1.22154161	1.176554307	0.954366972	1.161833333
1.442003523	1.283236686	1.296696915	1.145129665	1.074207849
1.535154238	1.047371429	0.928339731	1.022219482	0.99666
1.822187707	1.790363289	1.44532567	1.52746884	1.395552381
0.860670213	1.096156156	0.799508651	0.747377998	0.756142857
0.737151201	0.846341978	1.29471878	1.34154224	0.968635015
1.118357558	1.257899344	1.1266125	1.197228311	1.137120773
0.545675214	0.97568408	1.185380531	1.052015404	0.921163708
1.29225151	1.348658333	1.447263923	0.837897898	1.057071057
0.644016667	1.039079167	0.888763127	0.711120401	0.8918125
1.131738519	1.059126316	1.073733964	0.881503132	0.770902174
0.798299617	1.217421088	1.081181818	0.97240566	1.086477024
1.48628068	1.561741039	1.638701095	1.543452256	1.111618005]

%swimtime=swimdist4

probedist=[76.987	82.788
85.475	93.472
85.934	117.725
111.367	111.367
108.024	110.22
97.339	87.147
5.572	116.971
100.191	120.216
93.964	109.761
102.977	118.839
93.374	86.589
79.51	96.979
95.701	90.653
113.661	104.517
111.76	87.737
112.219	102.485
84.328	2.687
109.433	92.554
93.079	107.663
101.043	99.568
108.417	74.922
120.249	119.2
115.332	111.203
95.799	95.242
96.848	83.443
94.259	77.839
81.411	90.621
86.426	102.747
110.711	91.243
100.289	92.62
63.287	70.891
58.6	56.437
106.319	110.285
49.325	49.325
85.573	70.53
60.534	66.663
69.219	61.091
86.786	77.708
65.909	64.991
60.567	51.685
28.71	28.71
96.618	71.644];


time=[1 2 3 4 5]';
sex=[0
0
0
0
0
1
1
1
1
1
0
0
0
0
1
1
1
0
0
0
0
0
0
1
1
1
1
1
0
0
0
0
0
0
0
1
1
1
1
1
1
1]';

sex=['m'
'm'
'm'
'm'
'm'
'f'
'f'
'f'
'f'
'f'
'm'
'm'
'm'
'm'
'f'
'f'
'f'
'm'
'm'
'm'
'm'
'm'
'm'
'f'
'f'
'f'
'f'
'f'
'm'
'm'
'm'
'm'
'm'
'm'
'm'
'f'
'f'
'f'
'f'
'f'
'f'
'f']';
% gc=[repmat({'female'}, 3, 1)' repmat({'male'}, 5, 1)']
% gc2=gc'; 

gc=[0
0
0
0
0
0
0
0
0
0
0
0
0
0
0
0
0
3
3
3
3
3
3
3
3
3
3
3
4
4
4
4
4
4
4
4
4
4
4
4
4
4]';

gc2=gc';


genotype=['wt'
'wt'
'wt'
'wt'
'wt'
'wt'
'wt'
'wt'
'wt'
'wt'
'wt'
'wt'
'wt'
'wt'
'wt'
'wt'
'wt'
'e3'
'e3'
'e3'
'e3'
'e3'
'e3'
'e3'
'e3'
'e3'
'e3'
'e3'
'e4'
'e4'
'e4'
'e4'
'e4'
'e4'
'e4'
'e4'
'e4'
'e4'
'e4'
'e4'
'e4'
'e4']'; 
age=[120
120
120
120
120
120
120
120
120
120
367
367
367
367
400
400
400
393
393
393
383
383
383
388
388
388
394
394
379
379
379
379
379
396
396
383
383
383
396
396
396
396]';
% t=t(2:end,:)
% time=time(2:end);
% sex=sex(2:end);

t=table(genotype', sex', age', swimtime(:,1), swimtime(:,2), swimtime(:,3),swimtime(:,4), swimtime(:,5), ...
    'VariableNames', { 'genotype' , 'sex', 'age', 't1','t2', 't3', 't4', 't5'} )

rm=fitrm(t,'t1-t5 ~ genotype*sex', 'WithinDesign',time, 'WithinModel','separatemeans')

mytab=ranova(rm)

bl = multcompare(rm,'sex', 'By', 'Time')

bl = multcompare(rm,'sex', 'By', 'Time', 'ComparisonType', 'bonferroni')
bl = multcompare(rm,'genotype', 'By', 'Time', 'ComparisonType', 'bonferroni')
bl = multcompare(rm,'genotype', 'By', 'Time')

ind_e4=find(gc==4);
sex_e4=sex(ind_e4);
swimtime_e4=swimtime(ind_e4,:);
genotype_e4=gc(ind_e4);
t_e4=table(genotype_e4', sex_e4',  swimtime_e4(:,1), swimtime_e4(:,2), swimtime_e4(:,3),swimtime_e4(:,4), swimtime_e4(:,5), ...
    'VariableNames', { 'genotype_e4' , 'sex_e4', 't1','t2', 't3', 't4', 't5'} )
rm_e4=fitrm(t_e4,'t1-t5 ~ sex_e4', 'WithinDesign',time); %, 'WithinModel','separatemeans')
mytab=ranova(rm_e4)

bl = multcompare(rm,'sex_e4', 'By', 'Time')
bl = multcompare(rm,'time', 'By', 'Time')

[h p table stats]=ttest2(t_e4.t2(1:7),t_e4.t2(8:14))

% h =
% 
%      0
% 
% 
% p =
% 
%     0.0613
% 
% 
% table =
% 
%   -21.5731
%     0.5803
% 
% 
% stats = 
% 
%     tstat: -2.0647
%        df: 12
%        sd: 9.5110

